Check and Test
-------------------------------

## Check sudo version ( CVE-2019-14287 )
```
sudo -V | grep "Sudo ver" | grep "1\.[01234567]\.[0-9]\+\|1\.8\.1[0-9]\*\|1\.8\.2[01234567]"
```
ถ้าไม่ขึ้นอะไรแสดงว่าไม่อยู่ในช่วงช่วงเวอชั่นที่มีช่องโหว่

แต่ if version < 1.28
มีความเสี่ยงว่าจะมีช่องโหว่ทดสอบโดย
```
sudo -u#-1 /bin/bash
```

```
ช่องโหว่นี้เกิดจากการ handle ค่า uid ที่ส่งเข้ามาไม่ดี
โดยคำสั่งนี้คือการแจ้งขอเปลี่ยนสิทธิ์ในการรัน /bin/bash

เมื่อมีการส่งค่า -1 เข้ามา โดย Program เขียนด้วย C ชนิดตัวแปรที่รับเป็นชนิด uid_t (unsigned int) 
หมายความว่า ถ้าส่งค่าที่น้อยกว่า 0 เข้ามามันจะตีความเป็นค่าที่ไม่มีอยู่จริงของ user id
-1 ใน unsigned int จะได้ค่าเป็น 4294967295
4294967295 นี้ไม่มีแน่ๆในเลข user id
ดังนั้นเมื่อไม่เจอจึง fallback ให้สิทธิ์ root (uid 0 ) แทน
เราจึงทำการยกระดับสิทธิ์ได้โดยไม่ต้องใช้อย่างอื่นเลย
```
